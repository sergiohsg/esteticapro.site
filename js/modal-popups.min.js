!function(p){"use strict";var e={init:function(){p(document).ready((function(){!p(".wpr-template-popup").length||e.editorCheck()||(e.openPopupInit(),e.closePopupInit())}))},openPopupInit:function(){p(".wpr-template-popup").each((function(){var o=p(this),t=e.getID(o);if(e.checkAvailability(t)&&e.checkStopShowingAfterDate(o)){e.setLocalStorage(o,"show");var i=JSON.parse(localStorage.getItem("WprPopupSettings"))[t];if(!e.checkAvailableDevice(o,i))return!1;if(e.popupTriggerInit(o),"load"===i.popup_trigger){var a=1e3*i.popup_load_delay;p(window).on("load",(function(){setTimeout((function(){e.openPopup(o,i)}),a)}))}else if("scroll"===i.popup_trigger)p(window).on("scroll",(function(){var t=p(window).scrollTop()/(p(document).height()-p(window).height());(t=Math.round(100*t))>=i.popup_scroll_progress&&!o.hasClass("wpr-popup-open")&&e.openPopup(o,i)}));else if("element-scroll"===i.popup_trigger)p(window).on("scroll",(function(){var t=p(i.popup_element_scroll),a=p(window).scrollTop()+p(window).height();t.length&&(!(t.offset().top<a)||o.hasClass("wpr-popup-open")||e.openPopup(o,i))}));else if("date"===i.popup_trigger){var n=Date.now();Date.parse(i.popup_specific_date)<n&&setTimeout((function(){e.openPopup(o,i)}),1e3)}else if("inactivity"===i.popup_trigger){var r=null,s=1e3*i.popup_inactivity_time;p("*").bind("mousemove click keyup scroll resize",(function(){o.hasClass("wpr-popup-open")||(clearTimeout(r),r=setTimeout((function(){e.openPopup(o,i)}),s))})),p("body").trigger("mousemove")}else"exit"===i.popup_trigger?p(document).on("mouseleave","body",(function(){o.hasClass("wpr-popup-open")||e.openPopup(o,i)})):"custom"===i.popup_trigger&&(p(i.popup_custom_trigger).on("click",(function(){e.openPopup(o,i)})),p(i.popup_custom_trigger).css("cursor","pointer"));"0px"!==o.find(".wpr-popup-container-inner").css("height")&&new PerfectScrollbar(o.find(".wpr-popup-container-inner")[0],{suppressScrollX:!0})}}))},openPopup:function(o,t){"notification"===t.popup_display_as&&(o.addClass("wpr-popup-notification"),setTimeout((function(){p("body").animate({"padding-top":o.find(".wpr-popup-container").outerHeight()+"px"},1e3*t.popup_animation_duration,"linear")}),10)),t.popup_disable_page_scroll&&"modal"===t.popup_display_as&&p("body").css("overflow","hidden"),o.addClass("wpr-popup-open").show(),o.find(".wpr-popup-container").addClass("animated "+t.popup_animation),p(window).trigger("resize"),p(".wpr-popup-overlay").hide().fadeIn(),o.find(".wpr-popup-close-btn").css("opacity","0"),setTimeout((function(){o.find(".wpr-popup-close-btn").animate({opacity:"1"},500)}),1e3*t.popup_close_button_display_delay),!1!==t.popup_automatic_close_switch&&setTimeout((function(){e.closePopup(o)}),1e3*t.popup_automatic_close_delay)},closePopupInit:function(){p(".wpr-popup-close-btn").on("click",(function(){e.closePopup(p(this).closest(".wpr-template-popup"))})),p(".wpr-popup-overlay").on("click",(function(){var o=p(this).closest(".wpr-template-popup"),t=e.getID(o);0==e.getLocalStorage(t).popup_overlay_disable_close&&e.closePopup(o)})),p(document).on("keyup",(function(o){var t=p(".wpr-popup-open");if(t.length){var i=e.getID(t),a=e.getLocalStorage(i);27==o.keyCode&&0==a.popup_disable_esc_key&&e.closePopup(t)}}))},closePopup:function(o){var t=e.getID(o),i=e.getLocalStorage(t);"notification"===i.popup_display_as&&p("body").css("padding-top",0),e.setLocalStorage(o,"hide"),"modal"===i.popup_display_as?o.fadeOut():o.hide(),p("body").css("overflow","visible"),p(window).trigger("resize")},popupTriggerInit:function(o){var t=o.find(".wpr-popup-trigger-button");t.length&&t.on("click",(function(){var t=JSON.parse(localStorage.getItem("WprPopupSettings"))||{},i=p(this).attr("data-trigger"),a=p(this).attr("data-show-delay"),n=p(this).attr("data-redirect"),r=p(this).attr("data-redirect-url"),s=e.getID(o);"close"===i||"close-permanently"===i?(t[s].popup_show_again_delay=parseInt(a,10),t[s].popup_close_time=Date.now()):"back"===i&&window.history.back(),e.closePopup(o),localStorage.setItem("WprPopupSettings",JSON.stringify(t)),"back"!==i&&"yes"===n&&setTimeout((function(){window.location.href=r}),100)}))},getLocalStorage:function(p){var e=JSON.parse(localStorage.getItem("WprPopupSettings"));if(null==e)return!1;var o=e[p];return null!=o&&o},setLocalStorage:function(p,o){var t=e.getID(p),i=JSON.parse(p.attr("data-settings")),a=JSON.parse(localStorage.getItem("WprPopupSettings"))||{};a[t]=i,a[t].popup_close_time=!("hide"!==o)&&Date.now(),localStorage.setItem("WprPopupSettings",JSON.stringify(a))},checkStopShowingAfterDate:function(p){var e=JSON.parse(p.attr("data-settings")),o=Date.now();return!("yes"===e.popup_stop_after_date&&o>=Date.parse(e.popup_stop_after_date_select))},checkAvailability:function(o){var t=p("#wpr-popup-id-"+o),i=JSON.parse(t.attr("data-settings")),a=window.location.href;if("yes"!==i.popup_show_via_referral||-1!==a.indexOf("wpr_templates=user-popup")||-1!=a.indexOf(i.popup_referral_keyword)){if(!1===e.getLocalStorage(o))return!0;var n=t.find(".wpr-popup-trigger-button"),r=n.attr("data-show-delay"),s=Date.now(),u=e.getLocalStorage(o);if(r){var c=!0;if(n.each((function(){var e=p(this).attr("data-show-delay");u.popup_show_again_delay==parseInt(e,10)&&(c=!1)})),1==c)return!0}else if(u.popup_show_again_delay!=i.popup_show_again_delay)return!0;return!((u.popup_close_time||0)+parseInt(u.popup_show_again_delay,10)>=s)}},checkAvailableDevice:function(e,o){var t=p("body").prop("clientWidth");return 1024<t?!!o.popup_show_on_device:768<t?!!o.popup_show_on_device_tablet:!!o.popup_show_on_device_mobile},getID:function(p){return p.attr("id").replace("wpr-popup-id-","")},editorCheck:function(){return!!p("body").hasClass("elementor-editor-active")}};e.init()}(jQuery,window.elementorFrontend);